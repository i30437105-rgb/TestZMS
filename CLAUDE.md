# Правила проекта TestZMS

## Обязательно при старте сессии

1. Прочитай `DESIGN_SOURCE.md` — главный справочник дизайна (лендинг = первоисточник стиля)
2. Прочитай `PROMPT_DESIGN_SYNC.md` — промпт и правила работы по синхронизации дизайна
3. Проверь текущее состояние: какие решения уже утверждены (таблица в `DESIGN_SOURCE.md`)

## Обязательно после каждого утверждённого блока

1. Зафиксируй решение в `DESIGN_SOURCE.md` → таблица "Утверждённые решения"
2. Обнови любые связанные документы если нужно
3. Это КРИТИЧНО — при потере контекста файлы остаются, а память чата — нет

## Обязательно при восстановлении контекста (после сжатия или новой сессии)

1. Прочитай `DESIGN_SOURCE.md` полностью
2. Проверь таблицу утверждённых решений — это твоя "память"
3. Проверь текущее состояние компонентов (прочитай файлы, которые менялись)
4. Подтверди заказчику: "Восстановил контекст. Вот что уже сделано: [список]. Продолжаем с [блок]?"
5. НЕ продолжай работу молча — сначала убедись, что ничего не упущено

## Маршруты

- `/` → redirect на лендинг
- `/test` → тест (React)
- `/landing/index.html` → лендинг (статический HTML)

## Обязательно: git commit + push после каждой доработки

**КРИТИЧНО**: После каждого завершённого блока работы (утверждённая правка, фикс, новая фича) ассистент ОБЯЗАН:

1. `git add` — добавить изменённые файлы
2. `git commit` — с понятным сообщением на русском, формат: `[Тип] Краткое описание`
   - Типы: `[Feature]`, `[Fix]`, `[Design]`, `[Docs]`, `[Release]`
3. `git push origin master` — залить на GitHub

Это НЕ опционально. Без пуша изменения не попадают на Vercel и теряются при смене сессии.

## Деплой

- GitHub: `https://github.com/i30437105-rgb/TestZMS.git`
- Хостинг: Vercel (автодеплой при push в master)
- Переменные окружения на Vercel: `TELEGRAM_BOT_TOKEN`, `TELEGRAM_CHAT_ID`

## Ключевые правила

- Лендинг (`public/landing/`) = первоисточник дизайна для всего проекта
- НЕ менять то, о чём не просили
- Работать пошагово, один блок за раз
- Спрашивать, если неоднозначно
- Дизайн-решения принимает только заказчик

## Задачи на будущее (фронт работ)

### 1. Свой домен
- Купить домен (например, на reg.ru, timeweb, namecheap)
- В Vercel: Settings → Domains → Add Domain → прописать DNS (A-запись или CNAME)
- SSL-сертификат Vercel выдаёт автоматически
- **Статус**: не начато

### 2. Яндекс.Метрика (отслеживание трафика и конверсий)
- Создать счётчик в metrika.yandex.ru
- Вставить код счётчика в `app/layout.jsx` (head) и `public/landing/index.html`
- Настроить цели (конверсии):
  - Начало теста (клик «Начать тест»)
  - Завершение теста (экран результатов)
  - Отправка формы бонусов (клик «Забрать бонусы» → успех)
  - Клик «Записаться на аудит»
- Включить Вебвизор для записи сессий
- **Статус**: не начато

### 3. UTM-метки и отслеживание источников (Яндекс.Директ)
- Парсинг UTM-параметров из URL при входе на сайт
- Сохранение utm_source, utm_medium, utm_campaign, utm_content в sessionStorage
- Передача UTM вместе с данными формы в Telegram-бот и в БД
- Это позволит видеть: какой рекламный канал / объявление привело лид
- **Статус**: не начато

### 4. База данных (сохранение результатов тестов)
- **Бесплатный вариант**: Vercel Postgres (бесплатно до 256 МБ) или Supabase (бесплатно до 500 МБ)
- Что сохранять:
  - Все ответы пользователя (JSON)
  - Результат теста (процент, зелёные/красные блоки)
  - Данные формы (имя, Telegram)
  - UTM-метки
  - Дата/время прохождения
  - User-Agent, IP (опционально)
- Создать API route `/api/results` для записи
- Создать простую админку или выгрузку в CSV
- **Статус**: не начато

### 5. Пиксель Яндекс.Директ (ретаргетинг)
- Добавить код пикселя Яндекс.Аудиторий на все страницы
- Позволяет показывать рекламу тем, кто уже был на сайте
- **Статус**: не начато

### Приоритет выполнения
1. Яндекс.Метрика + цели (нужно ДО запуска рекламы)
2. UTM-метки (нужно ДО запуска рекламы)
3. Домен (желательно до рекламы, чтобы ссылка была красивой)
4. База данных (можно параллельно или сразу после)
5. Пиксель ретаргетинга (после запуска рекламы)
